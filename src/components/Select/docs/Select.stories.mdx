import { Canvas, Story, ArgsTable, Meta } from '@storybook/blocks';
import { StyledSystemLinks } from '../../../docs/StyledSystemLinks';
import { Select } from '../Select';

<Meta
    title="Form Elements/Select"
    component={Select}
    argTypes={{
        size: {
            options: ['normal', 'small'],
            defaultValue: 'normal',
            control: 'radio'
        },
        variant: {
            options: ['boxed', 'bottom-lined'],
            defaultValue: 'boxed',
            control: 'radio'
        },
        inverted: {
            options: [true, false],
            defaultValue: false,
            control: 'radio'
        },
        error: {
            options: [true, false],
            defaultValue: false,
            control: 'radio'
        }
    }}
/>

export const Template = args => (
    <Select {...args}>
        <option>Scooter</option>
        <option>Ride (PHV)</option>
        <option>Taxi</option>
    </Select>
);

# Select

This component is providing a dropdown select. It uses the native [HTML select](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/select) for a lightweight and efficient approach to file uploading.

<Canvas>
    <Story name="Default" args={{ label: 'City', id: 'city' }}>
        {Template.bind({})}
    </Story>
</Canvas>

## Properties

<ArgsTable of={Select} />

<StyledSystemLinks component="Select" supportedProps={['margin', 'width']} />

## Usage

They are typically used when user has 5-15 items to choose from.

## Appearance

-   **Label:** It should be a sentence and as short as possible while clearly explaining the content of the menu.
-   **Input:** by default we can include a value saying: ‘All [items name]’ or ‘Select an [item name]’
-   **Item list:** Contains the list of all selectable items. These can be grouped into sub-categories under headings.

## Placement

They mainly appear in forms but they can also be in other places, like dialog boxes and advanced search.

## Behavior

### Steps

1. User clicks into the text input field
2. The arrow icon placed in the input turns down and a list of possible options appear in front of all other permanent UI elements. This list appears just below the input, without hiding the input itself.
3. The user can then select a single option from that list.
4. The input is updated to show the option selected by the user

### Unselect option

Passing the `placeholder` will allow users to unselect their selected option. The value sent to the `onChange` handler
will be an empty string.

## Error state

Errors are shown just in the cases the field is mandatory and just after user clicks the send/save button in the form and never after leaving the select.

## Items List

-   When the list is longer than the layer shown, include a scroll to navigate
-   In cases where a menu item is longer than selector width, the menu will grow to the width of the longest item listed. However, there is a maximum width specified by the component. If the menu item exceeds the maximum width it will be truncated and we will use 3 dots including a tooltip mouse over to see all the content.
-   The options will be sorted in a way that will make the most sense to the user. They can be order:
    -   alphabetically
    -   numerically
    -   by most commonly selected option.
-   Remove options that rarely get used.
-   Remove the options that we know cannot be selected (eg: countries where we don’t work)

## Stories

### Bottom lined

<Canvas>
    <Story name="Bottom lined" args={{ label: 'City', id: 'city', variant: 'bottom-lined' }}>
        {Template.bind({})}
    </Story>
</Canvas>

### Error

<Canvas>
    <Story name="With error" args={{ label: 'City', id: 'city', error: true }}>
        {Template.bind({})}
    </Story>
</Canvas>

### Inverted

<Canvas style={{ background: '#001E3E' }}>
    <Story
        name="Inverted"
        parameters={{
            backgrounds: {
                default: 'dark'
            }
        }}
        args={{
            label: 'City',
            inverted: true
        }}
    >
        {Template.bind({})}
    </Story>
</Canvas>

## Testing

It is recommended for each Select component to set the `id`. This helps with a11y and allows to use the
`getByLabelText` selector in `@testing-library/react`.

Example:

```jsx
it('can be selected by label', () => {
    render(
        <Select defaultValue="2" label="Example" id="test">
            <option value="1">test 1</option>
            <option value="2">test 2</option>
        </Select>
    );

    userEvent.selectOptions(screen.getByLabelText('Example'), '1');

    expect(screen.getByLabelText('Example')).toHaveDisplayValue('test 1');
});
```
